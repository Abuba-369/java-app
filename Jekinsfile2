pipeline {
    agent any
    stages {
        stage ('checkout') {
            steps {
		checkout scm
            }
        }
        stage ('Build') {
            steps {
                sh '${m2_home}/bin/mvn -f java-sample-app/pom.xml clean install' 
            }
        }
	stage('Deploy') { 
	    steps { 
	              //puppet.credentials ‘pe-team-token’
		      puppet.hiera scope: 'development', key: 'build-version', value: 'v1.0.1'
		      puppet.credentials 'pe-access-token'
		sh 'scp /var/lib/jenkins/workspace/pipeline-test-2-abu/java-sample-app/target/*.war root@192.168.1.3:/root/tomcat/webapps'
		sh 'puppet agent -t'
	  }
      }
    }
}
